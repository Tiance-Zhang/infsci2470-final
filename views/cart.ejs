<!DOCTYPE html>
<html lang="en">
  
<head>
    <meta charset="UTF-8">
    <title>Cart</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous" />
</head>
<link rel="stylesheet" href="/style.css">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>

<body>


    <div class="container-fluid">
        <nav class="navbar navbar-expand-lg navbar-dark bg-dark fixed-top">

            <h2 style="color:white;">&nbsp;&nbsp;Checklist&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</h2>

            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarResponsive" aria-controls="navbarResponsive" aria-expanded="false" aria-label="Toggle navigation">
   <span class="navbar-toggler-icon"></span>
  </button>

            <div class="collapse navbar-collapse" id="navbarResponsive">
                <!--     <ul class="navbar-nav mr-auto">
      <li class="nav-item"><a class="nav-link" href="/index">Home</a></li>
      <li class="nav-item"><a class="nav-link" href="/product">Check All Shoes</a></li>
      <li class="nav-item"><a class="nav-link" href="/vendors">Check All Brands</a></li>
    </ul> -->

                <ul class="navbar-nav ml-auto">
                    <!--          <li class="nav-item"><a class="nav-link active" href="/myCart">My Cart</a ></li> -->
                    <li class="nav-item"><a class="nav-link" href="/mine">My Profile</a ></li>
          <li class="nav-item"><a class="nav-link" href="/dashboard">Log out</a></li>
                </ul>
            </div>
        </nav>
    </div>
    <br/><br/><br/><br/>

  
<!--  <div id="SurgicalSkills" class="classification">
   Surgical Skills/procedures
  </div>
  <div id="ClinicalSkills" class="classification">
   Clinical skills:Floor Patient Management
  </div>
  <div id="SurgicalCases" class="classification">
   Surgical Cases
  </div>
  <div id="PatientCare" class="classification">
   Patient care
  </div>
  <div id="Presentations" class="classification">
   Presentations
  </div>
  <div id="IntraoperativeSkills" class="classification">
   Intraoperative Skills
  </div>
  <div id="Orders" class="classification">
   Orders
  </div>
  <div id="SurgicalDiseases" class="classification">
   Surgical diseases
  </div>
  <div id="Imaging" class="classification">
  Imaging:ww.learningradiology.com or Stentor
  </div> -->

    <% if (list) { %>
        <!--   <p style="text-align:center;">There are <%= list.length %> products in the Cart.</p>
   <div class="row justify-content-center">
     <div class ="row">
       <div class="col-lg-8 col-md-7 col-sm-12 col-xs-12"> -->
        <div class="table-responsive">

            
                <% list.forEach(function(product){ %>
          <table class="checklist_table" id="checklist_table">
                    <tr name="list_id">
<!--                         <td class="list_id_button">id:
                            <%= product.Task_id %>
                        </td> -->
                      <td class="list_id_button">
                            <%= product.TaskName %>
                        </td>
                        <td rowspan="6" class="table_button">
                            <!--         <form action="/updateCart?id=<%= product.id %>" method="POST"> -->       
                            <form class="table_form" method="POST" action="/update?_method=PUT&id=<%= product.id %>" target="test">
<!--                             <form class="table_form" method="POST" action="/update?id=<%= product.id %>" > -->
                             
                                <button type="submit" class="change_status" onclick="window.location.href = 'https://grave-stellar-answer.glitch.me/myCart'" style="width:100%">Change status</button>
                                  
                            </form>
                        </td>
                    </tr>

<!--                     <tr>
                        <td>NAME:
                            <%= product.TaskName %>
                        </td>
                    </tr> -->
                    <tr>
                        <td>Instructor:
                            <%= product.Instructor %>
                        </td>
                    </tr>
                    <tr>
                        <td class="status"><%= product.status %></td>
                    </tr>
                    <tr>
                        <td>Room:
                            <%= product.Room %>
                        </td>
                    </tr>
                    <tr>
                        <td name="description"><%= product.Description %></td>
                    </tr>
 </table>
                    <% }); %>
           
        </div>

        <!--         </div><div class="col-lg-auto col-md-auto col-sm-10 col-xs-10">
      <div class="table-responsive text-center">
          <table class="table table-bordered" style="max-width:95%;">
      <tr><td ><h2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Summary&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</h2></td></tr>
      <tr><td>Total Price: <%= total_price %></td></tr>
      <tr><td align="center"><form action="/clearCart" method="POST">
         <button class="btn btn-secondary btn-lg btn-block" type="submit">
           Clear Cart
         </button>
    </form></td></tr>
    </table> </div></div> 
     </div></div>-->
        <% } else { %>
            <p>No products in the Cart.</p>
            <% } %>


<iframe name="test"></iframe>


                <!--   <br/><br/><br/><br/> -->

                <!--   <footer class="container-fluid bg-dark">
<p class="m-0 text-center text-white">Copyright &copy; Venom 2020</p>
</footer> -->

                <script>
                    $(document).ready(function() {
                      
                     $('.checklist_table').sort(function(a, b) {
                        return parseInt($(a).find('.status').html()) - parseInt($(b).find('.status').html());
                      }).appendTo($(".table-responsive"));
                      
                      
                        $("#checklist_table td").hide();
                        $("[name='list_id']").find('td').show();

                        $(".list_id_button").click(function() {

                        $(this).parent().parent().find('td').toggle();
                          $("[name='list_id']").find('td').show();
                          $(this).parent().parent().find('.status').hide();

                        });
                      
                      $("[name='list_id']").each(function(){
                      // console.log($(this).parent().find('.status').html());
                        switch($(this).parent().find('.status').html()) {
                          case "1":
                            $(this).attr('class', 'startedTask');
                            $(this).find('.change_status').html('Complete');
                            break;
                          case "2":
                            $(this).attr('class', 'nextWeekTask');
                            $(this).find('.change_status').html('Start');
                            break;
                          case "3":
                            $(this).attr('class', 'assignedTask');
                            $(this).find('.change_status').html('Next Week');
                            break;
                          case "4":
                            $(this).attr('class', 'finishedTask');
                            $(this).find('.change_status').html('Reset');
                            break;
                            
                        }
                      });
                      
                      $("[name='description']").each(function(){
                      // console.log($(this).parent().find('.status').html());
                        if (!$("[name='"+$(this).html()+"']").length){
                          let newDiv = document.createElement("div");
                          newDiv.setAttribute("name", $(this).html()); 
                          newDiv.setAttribute("class", "classification"); 
                          newDiv.append($(this).html()); 
                          document.body.appendChild(newDiv);
                        }
                        
                      });
       
                      
                      
                      var i = 0;
                      $(".checklist_table").each(function(){
                        console.log(i++);
                        if ($("[name='"+$(this).find("[name='description']").html()+"']").html() == $(this).find("[name='description']").html()){
                          var x = $(this).remove();
                          $("[name='"+$(this).find("[name='description']").html()+"']").append($(this));
                        }
                        
                      });
                      
                      
                      
                      
                    });
                </script>



</body>


</html>